\chapter{Operator}
\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators}{}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators}\index{Operator@{Operator}}
\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md37}%
\Hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md37}%
 Encapsulates a quantum operator, its couplings, and the ability to auto-\/generate block Hamiltonians at different locations and length scales. Tracks operator range, system size, optional disorder, and provides various convenience methods for operator algebra and property introspection.\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md38}{}\doxysubsection{\texorpdfstring{Initialization}{Initialization}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md38}

\begin{DoxyCode}{0}
\DoxyCodeLine{Operator(operator\_couplings:\ Coupling,\ name:\ Optional[str]=\textcolor{keywordtype}{None})}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{operator\+\_\+couplings}}\+: List describing the operator’s local terms and strengths. Each element is a tuple/list like {\ttfamily (\mbox{[}“zz”\mbox{]}, \mbox{[}J, J, ...\mbox{]})} or {\ttfamily (\mbox{[}“x”\mbox{]}, h)}. Can accommodate various interaction ranges and disorder.
\item {\bfseries{name}}\+: Optional label for easy identification.
\end{DoxyItemize}

\DoxyHorRuler{0}
 \hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md40}{}\doxysection{\texorpdfstring{Methods}{Methods}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md40}

\begin{DoxyItemize}
\item {\ttfamily expectation\+\_\+value(rho\+\_\+dict\+: Lattice\+Dict) -\/\texorpdfstring{$>$}{>} (Lattice\+Dict, float)}\+: Computes the expectation value for the operator with respect to a dictionary of density matrices. Returns\+: A dictionary with local expectation values and the total (summed) expectation value.
\item {\ttfamily operator} (property)\+: Generates a {\ttfamily Lattice\+Dict} containing all local operator blocks (CSR matrices) at the appropriate positions and levels. Handled via a cached property for efficiency.
\item {\ttfamily \+\_\+\+\_\+add\+\_\+\+\_\+}, {\ttfamily \+\_\+\+\_\+sub\+\_\+\+\_\+}\+: Define addition and subtraction between Operators, producing new ones that combine the respective couplings.
\item {\ttfamily \+\_\+\+\_\+mul\+\_\+\+\_\+}, {\ttfamily \+\_\+\+\_\+rmul\+\_\+\+\_\+}\+: Enables multiplication by a scalar. Supports syntax like {\ttfamily 3.\+0 \texorpdfstring{$\ast$}{*} Operator} and updates both sparse matrices and couplings.
\item {\ttfamily \+\_\+\+\_\+eq\+\_\+\+\_\+}\+: Compares Operators by their coupling definitions.
\end{DoxyItemize}

\DoxyHorRuler{0}
 \hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md42}{}\doxysection{\texorpdfstring{Example Usage}{Example Usage}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md42}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{from}\ local\_information.operator\_module\ \textcolor{keyword}{import}\ Operator,\ construct\_operator\_dict}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Define\ a\ Heisenberg\ Hamiltonian}}
\DoxyCodeLine{couplings\ =\ [}
\DoxyCodeLine{\ \ \ \ [\textcolor{stringliteral}{'zz'},\ [J,\ J,\ J,\ J]],}
\DoxyCodeLine{\ \ \ \ [\textcolor{stringliteral}{'xx'},\ [J,\ J,\ J,\ J]],}
\DoxyCodeLine{\ \ \ \ [\textcolor{stringliteral}{'yy'},\ [J,\ J,\ J,\ J]],}
\DoxyCodeLine{\ \ \ \ [\textcolor{stringliteral}{'z'},\ \ [h,\ h,\ h,\ h]],}
\DoxyCodeLine{]}
\DoxyCodeLine{op\ =\ Operator(couplings,\ name=\textcolor{stringliteral}{"{}Heisenberg"{}})}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Compute\ expectation\ value\ w.r.t.\ a\ supplied\ density\ matrix\ LatticeDict}}
\DoxyCodeLine{expt\_dict,\ total\_expt\ =\ op.expectation\_value(rho\_dict)}

\end{DoxyCode}
 \DoxyHorRuler{0}
 \hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md44}{}\doxysection{\texorpdfstring{Additional functions provided}{Additional functions provided}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md44}
\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md45}{}\doxysubsection{\texorpdfstring{Hamiltonian Construction Utilities}{Hamiltonian Construction Utilities}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md45}
These functions automate the creation and assembly of Hamiltonians at all relevant levels/hierarchies\+:


\begin{DoxyItemize}
\item {\ttfamily construct\+\_\+operator\+\_\+dict(...)}\+: Constructs a dictionary ({\ttfamily Lattice\+Dict}) of Hamiltonian matrices for multiple levels, using a specified coupling structure.
\item {\ttfamily construct\+\_\+hamiltonian(...)}\+: Builds a single Hamiltonian using Qu\+Spin given the coupling list, length ({\ttfamily n\+\_\+max -\/ n\+\_\+min}), and start position.
\item {\ttfamily get\+\_\+couplings(...)}\+: Adapts external coupling format to that required by Qu\+Spin, supporting both homogeneous and inhomogeneous interactions.
\item {\ttfamily compute\+\_\+\+HH\+\_\+commutator(...)}\+: Given a collection of Hamiltonians and a reference key (location, level), computes all commutators of the collection of Hamiltonians with the local Hamiltonian at the given key.
\item {\ttfamily compute\+\_\+\+H\+\_\+onsite\+\_\+operator\+\_\+commutator(...)}\+: Computes the commutator of the Hamiltonian with a single-\/site operator.
\item {\ttfamily add\+\_\+spins(operator, number, orientation)}\+: Enlarges an operator by adding identity operators ({\ttfamily I}) on the left or right, growing its Hilbert space appropriately (via Kronecker products). Used for alignment of operators and Hilbert spaces.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md46}{}\doxysubsection{\texorpdfstring{Lindbladian Construction Utilities}{Lindbladian Construction Utilities}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md46}
Functions for open-\/system quantum systems, where you may have local or structured dissipators ("{}\+Lindblad operators"{})\+:


\begin{DoxyItemize}
\item {\ttfamily check\+\_\+lindbladian(jump\+\_\+couplings, allowed\+\_\+strings)}\+: Validates the Lindbladian (dissipative) terms, checks the range/type, and identifies disorder.
\item {\ttfamily construct\+\_\+lindbladian\+\_\+dict(jump\+\_\+couplings, ...)}\+: Returns a dictionary mapping locations and levels to the onsite Lindblad operator(s) that act there. Useful for building the full dissipation superoperator.
\item {\ttfamily construct\+\_\+lindbladian\+\_\+id(n\+\_\+max, jump\+\_\+couplings, n\+\_\+min)}\+: For a specified block, returns a site-\/indexed list of Lindblad jump operator specifications (type and value).
\item {\ttfamily setup\+\_\+onsite\+\_\+\+L\+\_\+operators(max\+\_\+l, range\+\_\+, type\+\_\+list)}\+: Generates all possible one-\/site Lindblad operators, projected into extended Hilbert spaces as CSR matrices. These include Pauli ({\ttfamily x}, {\ttfamily y}, {\ttfamily z}), raising/lowering ({\ttfamily +}, {\ttfamily -\/}), and identity ({\ttfamily 1}).
\end{DoxyItemize}

\DoxyHorRuler{0}
 \hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_hamiltonian}{}\doxysection{\texorpdfstring{Hamiltonian}{Hamiltonian}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_hamiltonian}
The {\ttfamily Hamiltonian} class extends the generic {\ttfamily Operator} class to represent a Hamiltonian constructed from local couplings, organized as {\ttfamily Lattice\+Dict} structures holding subsystem Hamiltonians. These data structures support hierarchical decompositions up to a maximum correlation length {\ttfamily max\+\_\+l}.\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md48}{}\doxysubsubsection{\texorpdfstring{Initialization}{Initialization}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md48}

\begin{DoxyCode}{0}
\DoxyCodeLine{Hamiltonian(max\_l:\ int,\ hamiltonian\_couplings:\ Coupling)}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{max\+\_\+l}}\+: The maximum hierarchical correlation length (level). All local Hamiltonians are constructed up to (including) {\ttfamily max\+\_\+l + range\+\_\+of\+\_\+couplings} so that local time-\/evoultion can be performed up to level {\ttfamily max\+\_\+l}.
\item {\bfseries{hamiltonian\+\_\+couplings}}\+: Input list of local Hamiltonian couplings describing the system.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md49}{}\doxysubsubsection{\texorpdfstring{Attributes}{Attributes}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md49}

\begin{DoxyItemize}
\item {\ttfamily max\+\_\+l}\+: Maximum hierarchical level (correlation length) local operators are available for local time-\/evolution.
\item {\ttfamily hamiltonian\+\_\+couplings}\+: Input Hamiltonian operator couplings.
\item {\ttfamily subsystem\+\_\+hamiltonian}\+: {\ttfamily Lattice\+Dict} with all relevant subsystem Hamiltonians.
\item {\ttfamily disorder}\+: Boolean indicating the presence of disorder in couplings.
\end{DoxyItemize}

\begin{quote}
Note\+: The full Hamiltonian of the system can be reconstructed by summing values in the {\ttfamily operator} property. The {\ttfamily subsystem\+\_\+hamiltonian} attribute contains overlapping subsystem Hamiltonians, which do {\bfseries{not}} sum up to the full Hamiltonian due to overlap. \end{quote}
\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md50}{}\doxysubsubsection{\texorpdfstring{Properties}{Properties}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md50}

\begin{DoxyItemize}
\item {\ttfamily energy\+\_\+current}\+: A cached property that computes the commutator of the Hamiltonian with each local operator element of the Hamiltonian itself. It returns a dictionary mapping keys (location and level) to commutator {\ttfamily Lattice\+Dict}s.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md51}{}\doxysubsubsection{\texorpdfstring{Methods}{Methods}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md51}

\begin{DoxyItemize}
\item {\ttfamily operator\+\_\+current(operator\+: Operator) -\/\texorpdfstring{$>$}{>} dict\mbox{[}Lattice\+Dict\mbox{]}}\+: Computes the commutator of the Hamiltonian with {\itshape each element} of a given {\bfseries{onsite}} operator.
\item {\ttfamily save\+\_\+checkpoint(folder\+: str)}\+: Saves the Hamiltonian state to the specified folder.
\item {\ttfamily from\+\_\+checkpoint(folder\+: str) -\/\texorpdfstring{$>$}{>} Hamiltonian}\+: Class method to load a Hamiltonian object from a checkpoint directory.
\item {\ttfamily \+\_\+\+\_\+eq\+\_\+\+\_\+}\+: Two Hamiltonians are equal if their {\ttfamily operator} arrays are identical (same matrix elements) and their {\ttfamily max\+\_\+l} values match.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md52}{}\doxysubsection{\texorpdfstring{Usage Example}{Usage Example}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md52}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{from}\ local\_information.operators.hamiltonian\ \textcolor{keyword}{import}\ Hamiltonian}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Suppose\ hamiltonian\_couplings\ is\ your\ coupling\ list}}
\DoxyCodeLine{max\_l\ =\ 5}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Create\ Hamiltonian\ instance}}
\DoxyCodeLine{hamiltonian\ =\ Hamiltonian(max\_l=max\_l,\ hamiltonian\_couplings=hamiltonian\_couplings)}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Access\ energy\ current\ (commutators\ of\ Ham\ with\ itself)}}
\DoxyCodeLine{energy\_currents\ =\ hamiltonian.energy\_current}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Save\ to\ checkpoint}}
\DoxyCodeLine{hamiltonian.save\_checkpoint(\textcolor{stringliteral}{"{}saved\_hamiltonian"{}})}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Load\ from\ checkpoint}}
\DoxyCodeLine{loaded\_hamiltonian\ =\ hamiltonian.from\_checkpoint(\textcolor{stringliteral}{"{}saved\_hamiltonian"{}})}

\end{DoxyCode}


\DoxyHorRuler{0}
 \hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_lindbladian}{}\doxysection{\texorpdfstring{Lindbladian}{Lindbladian}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_lindbladian}
The {\ttfamily Lindbladian} class extends the generic {\ttfamily Operator} class to represent an {\bfseries{open quantum system’s Lindbladian operator}}, incorporating both Hamiltonian and dissipative (jump) terms. It organizes the Lindbladian into hierarchical local subsystems stored as {\ttfamily Lattice\+Dict} objects.\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md54}{}\doxysubsubsection{\texorpdfstring{Initialization}{Initialization}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md54}

\begin{DoxyCode}{0}
\DoxyCodeLine{Lindbladian(max\_l:\ int,\ hamiltonian\_couplings:\ Coupling,\ jump\_couplings:\ Coupling)}

\end{DoxyCode}



\begin{DoxyItemize}
\item {\bfseries{max\+\_\+l}}\+: Maximum correlation length. All local Lindbladians are built up to level {\ttfamily max\+\_\+l + range\+\_\+of\+\_\+couplings}.
\item {\bfseries{hamiltonian\+\_\+couplings}}\+: List of coupling terms defining the Hamiltonian part of the Lindbladian.
\item {\bfseries{jump\+\_\+couplings}}\+: List of on-\/site jump operator couplings describing dissipation.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md55}{}\doxysubsubsection{\texorpdfstring{Attributes}{Attributes}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md55}

\begin{DoxyItemize}
\item {\ttfamily max\+\_\+l}\+: Maximum hierarchical level (correlation length).
\item {\ttfamily hamiltonian\+\_\+couplings}\+: Input Hamiltonian operator couplings.
\item {\ttfamily jump\+\_\+couplings}\+: Jump operator (dissipators) couplings.
\item {\ttfamily subsystem\+\_\+hamiltonian}\+: {\ttfamily Lattice\+Dict} with all relevant subsystem Hamiltonians.
\item {\ttfamily lindbladian\+\_\+dict}\+: {\ttfamily Lattice\+Dict} giving information on where to apply local Lindblad operators.
\item {\ttfamily L\+\_\+operators}\+: {\ttfamily Lattice\+Dict} of all basic onsite Lindblad operators projected to correct Hilbert spaces.
\item {\ttfamily disorder}\+: Boolean indicating the presence of disorder in couplings.
\end{DoxyItemize}

\begin{quote}
Note\+: The full Lindbladian of the system can be reconstructed by summing values in the {\ttfamily operator} property. The {\ttfamily subsystem\+\_\+hamiltonian} attribute contains overlapping subsystem Hamiltonians, which do {\bfseries{not}} sum up to the full Hamiltonian due to overlap. \end{quote}
\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md56}{}\doxysubsubsection{\texorpdfstring{Properties}{Properties}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md56}

\begin{DoxyItemize}
\item {\ttfamily energy\+\_\+current}\+: A cached property that computes the commutator of the Hamiltonian with each local operator element of the Hamiltonian itself. It returns a dictionary mapping keys (location and level) to commutator {\ttfamily Lattice\+Dict}s.
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md57}{}\doxysubsubsection{\texorpdfstring{Methods}{Methods}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md57}

\begin{DoxyItemize}
\item {\ttfamily operator\+\_\+current(operator\+: Operator) -\/\texorpdfstring{$>$}{>} dict\mbox{[}Lattice\+Dict\mbox{]}}\+: Computes commutators of the Lindbladian’s Hamiltonian with each local element of an onsite operator.
\item {\ttfamily energy\+\_\+current} (cached property)\+: Computes the commutator of the Lindbladian’s Hamiltonian with each of its own local Hamiltonian elements.
\item {\ttfamily save\+\_\+checkpoint(folder\+: str)}\+: Saves the Lindbladian’s couplings and metadata to the specified folder.
\item {\ttfamily from\+\_\+checkpoint(folder\+: str) -\/\texorpdfstring{$>$}{>} Lindbladian}\+: Loads a {\ttfamily Lindbladian} instance from a checkpoint.
\item {\ttfamily \+\_\+\+\_\+eq\+\_\+\+\_\+(other)}\+: Checks equality with another {\ttfamily Lindbladian} instance. Two {\ttfamily Lindbladian} instances are considered equal if {\ttfamily operator} matrices, {\ttfamily max\+\_\+l} values and {\ttfamily L\+\_\+operators} are equal
\end{DoxyItemize}\hypertarget{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md58}{}\doxysubsection{\texorpdfstring{Usage Example}{Usage Example}}\label{md__2_users_2christoph_2local-information_2local__information_2docs_2operators_autotoc_md58}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{from}\ local\_information.operators.lindbladian\ \textcolor{keyword}{import}\ Lindbladian}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Define\ couplings\ for\ Hamiltonian\ and\ jump\ dissipators}}
\DoxyCodeLine{hamiltonian\_couplings\ =\ [...]\ \ \textcolor{comment}{\#\ your\ coupling\ list\ here}}
\DoxyCodeLine{jump\_couplings\ =\ [...]\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ on-\/site\ jump\ operators}}
\DoxyCodeLine{}
\DoxyCodeLine{max\_l\ =\ 5}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Create\ Lindbladian\ instance}}
\DoxyCodeLine{lindbladian\ =\ Lindbladian(max\_l=max\_l,\ hamiltonian\_couplings=hamiltonian\_couplings,\ jump\_couplings=jump\_couplings)}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Save\ the\ Lindbladian\ to\ disk}}
\DoxyCodeLine{lindbladian.save\_checkpoint(\textcolor{stringliteral}{"{}checkpoints/lindbladian\_run1"{}})}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{\#\ Load\ it\ back\ later}}
\DoxyCodeLine{loaded\_lindbladian\ =\ Lindbladian.from\_checkpoint(\textcolor{stringliteral}{"{}checkpoints/lindbladian\_run1"{}})}

\end{DoxyCode}
 